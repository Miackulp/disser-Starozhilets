\chapter{Математические модели транспортных потоков}\label{ch:ch1}

\section{Макроскопические модели}\label{sec:ch1/sec1}
Развитие макроскопического моделирования транспортных потоков восходит к исследованиям движения жидкости и газа в середине прошлого века.
В этом разделе мы рассмотрим основные модели предложенные в то время, их связь с современными исследованиями, а также возможные обобщения.

\subsection{Модель Лайтхилла-Уизема-Ричардса (LWR)}\label{subsec:ch1/sec1/sub1}
В 1955 году независимо в работах~\cite{LWR/lighthill1955kinematic,richards1956shock} была по видимому предложена первая гидродинамическая модель однополосного транспортного потока названная в честь её создателей моделью Лайтхилла-Уизема-Ричардса (LWR).
Однополосная дорога в данном случае считалось бесконечной в обе стороны дорогой с движением слева на право без источников и стоков автомобилей.
Поток автомобилей рассматривался как поток сжимаемой жидкости в рамках следующих постулатов:
\begin{itemize}
  \item существует взаимно однозначное соответствие между скоростью \(v(t, x)\) и плотностью потока АТС \(\rho(t, x)\) называемое уравнением состояния;
  \item выполняется закон сохранения числа АТС.
\end{itemize}
Где \(t\)~--- момент времени, \(x\)~--- координата трассы.
Таким образом запись \(\rho(t, x)\), \(v(t, x)\) обозначает соответствующую величину в момент времени \(t\) в окрестности координаты \(x\).
В дальнейшем в рамках макроскопического подхода мы предполагаем, что транспортный поток подчиняется некоторой микроскопической модели, в которой детально описывается поведение АТС в зависимости от окружающей обстановки и эта модель является разностным или дифференциально-разностным аналого рассматриваемой нами макроскопической модели.
Рассматривание же именно макроскопической модели обусловлено как большей наглядностью в виде гидродинамических аналогий так и ввиду относительной простоты их исследования.

Итак, первое предположение можно выразить следующим образом:
\begin{equation}
    \label{eq:equation1}
    \left\{
    \begin{array}{rl}
        v(t, x) = V(\rho(t, x)),\\
        V^{'}(\rho(t, x)) < 0
    \end{array}
    \right.
\end{equation}
Предполагается, что скорость не может возрастать с увеличением плотности потока АТС.
Обозначим
\[
    Q(\rho) = \rho V(\rho)
\]
количество АТС проходящих в единицу времени через заданное сечение.
Зависимость \( Q(\rho) \) называют также фундаментальной диаграммой потока.
Понятие фундаментальной диаграммы, её построение на реальных данных и ограничения на неё накладываемые являются одной из тем многих статей макроскопического моделирования.
Отметим только, что понятие фундаментальной диаграммы не совсем корректно на малых плотностях АТС \( \rho \backsim 50-120 \) АТС/км~\cite{kerner2009introduction}.
Иначе говоря на таких плотностях нет чёткой зависимости скорости от плотности.

Закон сохранения выражается следующим образом:
\[
    \int_{a}^{b} \rho(t + \delta, x)dx + \int_{a}^{b} \rho(t, x)dx = -\left\{\int_{t}^{t + \delta} Q(\rho(\tau, b))d\tau - \int_{t}^{t + \delta} Q(\rho(\tau, a))d\tau \right\}.
\]

Таким образом любого прямоугольного контура при $x\in \mathbb{R}, t\geq 0$ выполняется:
\[
    \oint \rho(t, x)dx - Q(\rho(t, x))dt = 0.
\]
Отсюда, для любого кусочно гладкого контура в точках гладкости \( \rho(t, x) \):
\begin{equation}
    \label{eq:equation2}
    \frac{\partial \rho}{\partial t} + \frac{\partial Q(\rho)}{\partial x} = 0.
\end{equation}

Дополним это уравнение начальными условиями типа Римана
\begin{equation}
    \label{eq:equation3}
    \rho(0, x) =
    \left\{
    \begin{alignedat}{3}
        &&\rho_{-},\quad &x<x_{-},  \\
        &&\rho_{0}(x),\quad x_{-}\leq &x<x_{+},  \\
        &&\rho_{-},\quad &x\geq x_{+}.
    \end{alignedat}
    \right.
\end{equation}

В дальнейшем соотношения~\cref{eq:equation1,eq:equation2} вкупе с различными граничными условиями~\cref{eq:equation3} и фундаментальной диаграммой потока позволяют решать различные задачи от моделирования движения автомобилей на свободной трассе до задач распространения затора, в которой одно из граничных условий приобретает вид \(\rho_{+} = \rho_{max}\) --- то есть плотность автомобилей максимальна.


\subsection{Модель Танака}\label{subsec:ch1/sec1/sub2}
В 1963 году Танака и другие~\cite{inose1983control} предложили один из способов определения зависимости \( V(\rho) \).
В условиях однополосного потока и ограниченности максимальной скорости сверху предлагалось:
\[
\rho(v) = \frac{1}{d(v)},
\]
где
\begin{equation}
    \label{eq:equation4}
    d(v) = L + c_1v + c_2v^2
\end{equation}
--- среднее расстояние между АТС при заданной скорости движения.
Величину $d(v)$ также называют динамическими габаритами.
Её также можно интерпретировать как участок автомобиля вместе с его дистанцией экстренного торможения.

В формуле~\cref{eq:equation4} \(L\)~--- средняя длина автомобилей, \(c_1\)~--- характеристика реакции водителей, \(c_2\)~--- коэффициент тормозного пути, зависящий в первую очередь от погодных условий.

Несмотря на свою простоту модель Танака играет важную роль в исследованиях транспортных потоков до сих пор~\cite{gartner2002traffic}, а динамические габариты автомобилей использованы и в данной работе.

\subsection{Модель Уизема}\label{subsec:ch1/sec1/sub3}
Следующий шаг упоминающийся еще в середине прошлого века, но окончательно предложенный лишь в 1974 году Дж. Уиземом~\cite{uisem1977linear} заключается в учёте того факта, что автомобилисты принимают решение о увеличении и уменьшении своей скорости на основе плотности потока перед ними, что выливается в следующее изменение~\ref{eq:equation1}:
\[
    v(t, x) = V(\rho(t, x)) - \frac{D(\rho(t, x))}{\rho(t,x)}\frac{\partial\rho(t,x)}{\partial x},\ \ D(\rho) > 0.
\]
Откуда, с учетом закона сохранения числа АТС~\ref{eq:equation2} получаем закон сохранения с нелинейной дивергентной диффузией:
\[
    \frac{\partial \rho}{\partial t} + \frac{\partial Q(\rho)}{\partial x} = \frac{\partial}{\partial x} \left(D(\rho) \frac{\partial \rho}{\partial x}\right).
\]
Таким образом получаем уравнения учитывающие тот факт, что автомобилисты снижают скорость при увеличении плотности АТС впереди и наоборот.


\subsection{Модель Пейна}\label{subsec:ch1/sec1/sub4}
Модель Пейна предложенная в 1971 году~\cite{payne1971model} также является учётом особенностей реального движения в транспортной сети.
В данной модели закон сохранения числа автомобилей все также имеет вид~\cref{eq:equation2}
\[
    \frac{\partial \rho}{\partial t} + \frac{\partial \rho v}{\partial x} = 0.
\]

Теперь, однако, учитывается тот факт, что при изменении плотности АТС на трассе скорость не может моментально изменится, а меняется следующим образом:
\[
\frac{d}{dt}v = \frac{\partial v}{\partial t} + v \frac{\partial v}{\partial x} = -\frac{1}{\tau} \left(v - \left(V(\rho) - \frac{D(\rho)}{\rho}\frac{\partial\rho}{\partial x}\right)\right),
\]
где скорость стремиться к некоторой желаемой скорости \( V(\rho) - \frac{D(\rho)}{\rho}\frac{\partial\rho}{\partial x}\) с некоторой характеристикой скорости стремления \(\tau\).
Отметим, что в литературе принято называть моделью Пейна частный случай вышеизложенной модели с \(D(\rho)\equiv\tau c_0^2 > 0\)

Перепишем систему уравнений в следующем виде:
\begin{equation}
    \label{eq:equation5}
  \frac{\partial}{\partial t}\binom{\rho}{v} +
  \left(
        \begin{array}{cc}
            v  & \rho \\
            D/(\tau\rho)  & v \\
        \end{array}
    \right)\cdot \frac{\partial}{\partial x} \binom{\rho}{v} = \frac{1}{\tau}\binom{0}{V-v}.
\end{equation}
Поскольку матрица при \(\frac{\partial}{\partial x}\) имеет различные собственные вещественные значения данная система очевидно является гиперболической.


\subsection{Современные исследования и обобщения}\label{subsec:ch1/sec1/sub5}
В дальнейшем развитие макроскопических моделей привело к нелинейным гиперболическим уравнениям второго порядка для скорости и плотности потока в различны постановках, зависящих от конкретного метода учёта тех или иных особенностей поведения автомобилистов на автомагистрали~\cite{payne1971model,daganzo1995requiem,papageorgiou1998some,zhang2002non,zhang2003anisotropic,siebel2006fundamental}.
Однако, в~\cite{collectiveArticle} было показано что все они так или иначе сводятся к следующему диагональному виду:
\[
\left\{
\begin{array}{rl}
  &\frac{\partial\rho}{\partial t} + \frac{\partial Q}{\partial\rho}\frac{\partial\rho}{\partial x} = f_0 \\
  &\frac{\partial v}{\partial t} + \frac{\partial Q}{\partial\rho}\frac{\partial v}{\partial x} = (\frac{\partial Q}{\partial\rho} - v) \frac{f_0}{\rho} + f_1
\end{array}
\right.
\]
путём использования обобщенного уравнения состояния --- зависимости давления от плотности транспортного потока \(P(\rho) = \int_{0}^{\rho} c(\tilde{\rho})^2 d\tilde{\rho} = \int_{0}^{\rho} \tilde{\rho}^2 (\frac{\partial v(\tilde{\rho})}{\partial \tilde{\rho}})^2\),
замыкающего исходную систему уравнений.
При этом \(f_1\) в правой части будет играть роль релаксационного слагаемого в случае необходимости в нём.

Окончательно, в~\cite{collectiveArticle} было показано что именно вид уравнения состояния, замыкающего систему модельных уравнения --- зависимости интенсивности транспортного потока от его плотности, полностью определяет свойства любой феноменологической модели.

Отметим, что для нелинейного закона сохранения~\ref{eq:equation2} гладкое решение задачи Коши~\ref{eq:equation2, eq:equation3} существует только в малой окрестности линии начальных условий. Для нелинейных уравнений с разрывными начальными условиями решение задачи Коши не определяется даже в сколь угодно малой окрестности начальных условий.
Для разрешимости поставленной задачи с такими начальными условиями необходимо рассматривать разрывные решения уравнения и иначе ставить задачу Коши.
Таким образом для различных постановок из разделов~\ref{subsec:ch1/sec1/sub1,subsec:ch1/sec1/sub2,subsec:ch1/sec1/sub3,subsec:ch1/sec1/sub4} и др. необходимо отдельно исследовать разрешимость задачи в случае разрывных начальных условий.
Это накладывает существенные ограничения на моделирование светофорного управления автомагистралью когда светофор резко перекрывает поток автомобилей, то есть разрывным образом изменяет плотность автомобилей и их скорость и вынуждает исследователя проводить дополнительные доработки и модификации для проведения такого рода экспериментов.

\section{Микроскопические модели}\label{subsec:ch1/sec2}
В данном разделе кратко описываются основные классы микроскопических моделей сформулированные ещё в середине прошлого века, а также скажем несколько слов об их связи с макроскопическими моделями.

\subsection{Модель оптимальной скорости Ньюэлла}\label{subsec:ch1/sec2/sub1}
Также как и в макроскопических моделях положим изначально что АТС движутся в однополосном потоке слева направо. 
Тогда, для всех \(t>0\) положим:
\begin{equation}
    \label{eq:newell_base}
    h_n(t) = s_{n+1}(t) - s_n(t),\ v_n(t)=s_n^{'}(t),
\end{equation}
где \(s_n(t)\)~--- координата центра \(n\)-го АТС в момент времени \(t\).

Микроскопическая модель Ньюэлла, предложенная в 1961 году~\cite{newell1961nonlinear} постулирует существование для каждого водителя некоторой безопасной скорости движения, зависящей от его расстояния до лидера:
\begin{equation}\label{eq:newell}
  h_n(t+\tau) = V\left(\frac{1}{h_n(t)}\right),
\end{equation}
где \(\tau\)~--- время, характеризующее скорость реакции водителей.
Аналогично модели LWR постулируется также \(V^{'}(\rho) < 0\).

Определение функциональной зависимости \(V(\rho)\) может быть как и на основе реальных данных так и чисто математическим.
Так, например, если принять за \(L\)~--- среднюю длину АТС на трассе, то в близи точки \(\rho_{max} \backsim 1/L \) фундаментальная диаграмма примет следующий вид:
\[
    Q(\rho) = -\frac{L}{\tau}(\rho - \rho_{max}).
\]
Таким образом на основе~\ref{eq:newell_base, eq:newell} возможно построить вычислительную процедуру позволяющую определить положение и скорость всех автомобилей на трассе в любой момент времени \(t>0\).

Отметим также, что путем несложных вычислений из данной модели можно фактически вывести модель Пейна, если же счесть \(\tau=0\), то получим модель Уизема.
Если же вообще пренебречь малыми слагаемыми при преобразованиях, то можно получить базовую модель LWR~\cite{gasn2017introd}.

Таким образом прослеживается явная связь микроскопических и макроскопических моделей.


\subsection{Модель следования за лидером <<Дженерал Моторс>>}\label{subsec:ch1/sec2/sub2}
Вторым важным классом микроскопических моделей являются модели следования за лидером.
В 1961 году Д.Газис, Р.Херман и Р.Роэри предложили следующую модель~\cite{gazis1974traffic}:
\[
    s_n^{''}(t+\tau) = \beta \frac{(s_n^{'}(t+\tau))^{m_1}}{(s_{n+1}(t) - s_n(t))^{m_2}}(s_{n+1}^{'}(t) - s_n^{'}(t)),\ \beta>0,
\]
где \(m_1<1,\ m_2>1\)~--- эмпирически подбираемые константы.
В рамках данной математической модели путём интегрирования можно получить следующее уравнение состояния транспортного потока (а следовательно и фундаментальную диаграмму потока):
\[
    V(\rho) = V^0\cdot\left(1 - \left(\frac{\rho}{\rho_{max}}\right)^{m_2 - 1} \right)^{\frac{1}{1-m_1}},
\]
где \(V^0\)~--- скорость движения на пустой трассе.

Несколькими годами ранее в 1959 году сотрудниками <<Дженерал Моторс>> Д.Газисом, Р.Херманом и Р.Потсом уже предлагалась схожая, но более простая модель:
\[
    s_n^{''}(t+\tau) = \beta \frac{s_{n+1}^{'}(t) - s_n^{'}(t)}{s_{n+1}(t) - s_n(t)},\ \beta>0,
\]
в которой ускорение каждого автомобиля прямо пропорционально его разности скорости с впереди идущим и обратно пропорционально расстояния до впереди идущего АТС.
В данной более простой модели также можно получить функциональную зависимость \(V(\rho)\), причём она была экспериментально обнаружена в том же году на данных о дорожном движении для туннеля Линкольна в Нью~-~Йорке.

Таким образом в течении нескольких лет сотрудники концерна предложили сразу несколько нетривиальных микроскопических моделей транспортного потока с помощью которых можно получить фундаментальную диаграмму согласующуюся при этом с экспериментальными данными.


\subsection{Модель Трайбера <<разумного водителя>>}\label{subsec:ch1/sec2/sub3}
Следующим логическим шагом в развитии микроскопических моделей была попытка объединения моделей оптимальной скорости и следования за лидером.
Данные модели были названы моделями разумного водителя или Intelligent Driver Model, IDM:
\[
    s_n^{''}(t) = F(s_{n+1}(t) - s_n(t), s_{n+1}^{'}(t) - s_n^{'}(t)). 
\]
По результатам численных экспериментов наиболее удачной с точки зрения устойчивости к изменению параметров а также реалистичности поведения при разгоне и торможении вкупе с наблюдаемостью основных свойств реального однополосного транспортного потока оказалась модель М.Трайбера предложенная в 1999 году~\cite{treiber1999explanation}:
\[
    s_n^{''}(t) = a_n\cdot \left( 1 - \left( \frac{s_n^{'}(t)}{V_n^0} \right)^{\delta} - \left(\frac{d_n^*(s_n^{'}(t), s_{n+1}^{'} - d_n^{'}(t))}{s_{n+1}(t) - s_n(t)}\right)^2 \right),
\]
где \(d_n^*\)~--- желаемая дистанция до лидера или же безопасное расстояние, \(V_n^0\)~--- желаемая скорость.
Видно, что данная модель состоит из двух членов относящихся к желаемой скорости и следованию за лидером соответственно:
\[
\begin{array}{rl}
    a_n\cdot \left( 1 - \left( \frac{s_n^{'}(t)}{V_n^0} \right)^{\delta}\right) \\
    a_n\cdot \left( \left(\frac{d_n^*(s_n^{'}(t), s_{n+1}^{'} - d_n^{'}(t))}{s_{n+1}(t) - s_n(t)}\right)^2 \right)
\end{array}
\]
В соответствии с данной моделью в различных начальных постановках и предположениях о составе транспортного потока можно также получить выражение для фундаментальной диаграммы.
Например в равновесном потоке одинаковых АТС, при
\[
    s_n^{''}(t) \equiv 0,\ s_{n+1}^{'}(t) - s_n^{'}(t) \equiv 0,\ s_n^{'}(t)\equiv V,
\]
а также считая \(\delta\rightarrow \infty\) что соответствует разгону с постоянным ускорением \(a_n\) получим фундаментальную диаграмму треугольной формы:
\[
    Q(\rho) = \min\left\{\rho V^0, \frac{1-d\rho}{T} \right\}
\]

Модели разумного водителя логически замыкают серию микроскопических моделей следования за лидером и оптимальной скорости и позволяют более точно моделировать реальную транспортную сеть.


\subsection{Модель клеточных автоматов}\label{subsec:ch1/sec2/sub4}
Другим типом микроскопических моделей являются модели клеточных автоматов.
В них дорога разбивается на дискретные клетки, а время также считается дискретной величиной.
Зачастую считается, что в одной клетке содержится только одно АТС, но это не обязательное условие.
Отдельно отметим, что даже скорость автомобилей в таких моделях может быть дискретной величиной.

Сама концепция клеточных автоматов была введена Дж. фон Нейманом в середине прошлого века~\cite{neiman2010dj}.
Первые попытки использования данных моделей в транспортном моделировании восходят к 1986 году, однако активное их использование началось после работ К.Нагеля и М.Шрекенберга в 1992 году~\cite{nagel1992cellular}.
Опишем кратко эту важную для развития микроскопического моделирования модель.

\begin{description}
  \item[Шаг 1] Ускорение:
    \[
        v_n(m+1) = \min\{v_n(m) + 1, v_{max}\}
    \]
  \item[Шаг 2] Торможение:
    \[
        v_n(m+1) = \min\{v_n(m), s_{n+1}(m) - s_n(m) - d\}
    \]
  \item[Шаг 3] Случайные возмущения связанные с различием в поведении АТС:
    \[
        v_n(m+1) = 
        \left\{
        \begin{alignedat}{3}
            &\max\{v_n(m) - 1, 0\} \quad&\text{с вероятностью}\ p,  \\
            &v_n(m) \quad&\text{с вероятностью}\ 1 - p
        \end{alignedat}
        \right.
    \]
  \item[Шаг 4] Движение:
    \[
        s_n(m+1) = s_n(m) + v_n(m)
    \]
\end{description}
В данном алгоритме шаг 1 отвечает за желание автомобилистов двигаться наиболее быстро не превышая максимально допустимую скорость, шаг 2 гарантирует отсутствие столкновений с впереди идущими АТС, шаг 3 отражает неустойчивость транспортного потока при достаточно больших плотностях.

Несмотря на дискретность данной модели в работах~\cite{benassi1987hydrodynamical} показано как перейти от нее к гидродинамическим моделям.
Также как и для других микроскопических моделей возможно получение соответвтующей фундаментальной диаграммы потока.

\section{Мезоскопические модели}\label{subsec:ch1/sec3}
Распространённость мезоскопических моделей крайне мала по сравнению с микро- и макроскопическими моделями.
Так, например, в обзоре~\cite{boxill2000evaluation} от 2000 года из 84 моделей 65~--- микроскопические, 16~--- макроскопические и всего лишь 3~--- мезоскопические.

В мезоскопических моделях зачастую автомобили рассматриваются в отдельности, однако их перемещение описывается совокупными соотношениями.
Так, например, в модели~\cite{lovaas1994modeling} рассматривается движение людей в здании, что в общем случае аналогично перемещению автомобилей в транспортной сети, в котором каждый человек движется индивидуально в соответствии со своей целью, однако их скорость движения задаётся эмпирической зависимостью \(V(\rho)\).
В работе~\cite{treuille2006continuum} проводится попытка применения механики сплошной среды к движению людей, однако с использованием некоторых индивидуальных характеристик каждого человека. Так, например, используется величина минимального попарного расстояния между людьми.

Из моделей автомобильного движения можно привести работу~\cite{kanai2010two} в которой используется одномерный мизантропический процесс (misanthrope process) вкупе с эмпирической зависимостью \(V(\rho)\) для моделирования двухполосной автомагистрали. 
В данной работе фактически используется микроскопический подход клеточных автоматов с мизантропической функцией перехода между клетками.
Ещё один подход изложен в работах~\cite{burghout2005hybrid,magne2000towards}. Его суть заключается в использовании микроскопического моделирования лишь в некоторых интересующих исследователей областях, в которых необходима более высокая точность, вся же остальная транспортная сеть моделируется макроскопической моделью.

Видно, что подходы к мезоскопическому моделированию сильно различаются от исследования к исследованию в зависимости от поставленных в работе задач.
Исследователи принимают решение о том где использовать подходы микроскопического моделирования с целью повышения точности своей работы, в то время как подходы макроскопических моделей позволяют упростить многие расчёты и ускорить работу вычислительных комплексов.
В данной работе также предлагается использовать мезоскопическую модель транспортных потоков с целью ускорения расчётов необходимых в процессе управления числом въезжающих на автомагистраль АТС.


\FloatBarrier 